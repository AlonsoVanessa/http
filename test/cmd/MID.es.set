/*
    MID.es.set
 */
require ejs.unix

tset('libraries', 'http mpr')

let json = Path('http.json').readJSON()
let httpEndpoint = json.app.http.server.listen[0]
let sslEndpoint = json.app.http.server.listen[1]

if (tphase() == 'Setup') {
    tset('TM_HTTP', httpEndpoint)
    tset('TM_HTTPS', sslEndpoint)
}

//  TODO - use TM_BIN
let httpServer = Path(tget('TM_CFG')).join('bin/http-server')
startStopService(httpServer, {address: httpEndpoint})
