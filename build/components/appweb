#
#   Appweb
#
defineComponent() {
	local iflags builtin path name search optional libs

    path=$1
    name="appweb"
    search="src/deps/appweb:src/$name:src/server"

    if [ "$path" != "" ] ; then
        libpaths=`probe --name libappweb --search "$path:$path/out/lib" "libappweb" `
        iflags=-I`probe --name appweb.h --search "$path:$path/src/include" "appweb.h"`
        path=`probe --emit-dir --path "$path" --partial "appweb.c" --search "$search" $name`
        if [ "$path" = "" ] ; then
            warnComponent $name
            return
        fi
    fi
    libs="$name"

    optional="ssl"
	if [ "$BLD_STATIC" = 1 ] ; then
		if [ "$BLD_PRODUCT_APPWEB" = 1 ] ; then
        	if isdefined EJS ; then
				optional="$optional ejs"
                # NOTE: ejs second because required on Linux static builds for appweb
				libs="$libs ejs"
			fi
			if isdefined PHP ; then
				optional="$optional php"
			fi
		fi 
	fi

    deps="mpr"
    if [ -d src/deps ] ; then
        deps="$deps http"
    fi

    configureComponent --libs "$libs" --libpaths "$libpaths" --iflags "$iflags" \
        --dependencies "$deps" --optional-dependencies "$optional" appweb
}
